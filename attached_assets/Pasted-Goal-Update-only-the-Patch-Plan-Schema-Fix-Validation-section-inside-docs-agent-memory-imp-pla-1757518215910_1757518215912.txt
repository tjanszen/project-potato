Goal: Update only the "Patch Plan: Schema Fix & Validation" section inside docs/agent_memory/imp_plans/v2.md.

Do:
- Find the section in docs/agent_memory/imp_plans/v2.md titled "Patch Plan: Schema Fix & Validation".
- Replace just that section with the following corrected version (no documentation step), leaving the rest of the file unchanged:

## üõ†Ô∏è Patch Plan: Schema Fix & Validation (v2)

**Goal:**  
Ensure the `day_marks` table schema matches Drizzle definitions. Specifically, correct the column naming mismatch (`date` vs `local_date`) before proceeding with further phases. This patch ensures the application and database stay aligned.

---

### Step 1: Schema Check
- List current DB tables: `\dt`
- Show schema for `day_marks`: `\d+ day_marks`
- Compare against Drizzle‚Äôs `shared/schema.ts`

üëâ **Output:** Confirm mismatch (table has `date`, Drizzle expects `local_date`).

---

### Step 2: Migration Apply
- If mismatch is found, apply safe column rename:
  ALTER TABLE day_marks RENAME COLUMN date TO local_date;
- Verify schema after migration with `\d+ day_marks`
- Confirm no data loss (all rows preserved)

üëâ **Output:** Schema updated, `local_date` column present.

---

### Step 3: Validation
- Retry marking a day:
  curl -X POST http://0.0.0.0:$PORT/api/days/2025-09-08/no-drink \
    -H "Content-Type: application/json" \
    -b test_cookies.txt -c test_cookies.txt -v
- Expect **HTTP 200** response
- Query database:
  SELECT local_date, user_id, value
  FROM day_marks
  ORDER BY local_date DESC
  LIMIT 5;

üëâ **Output:** New row for marked day appears with `local_date=2025-09-08`.

---

### Rollback
If migration introduces issues:
  ALTER TABLE day_marks RENAME COLUMN local_date TO date;

---

### Blast Radius
- **Low** ‚Äî affects only one column name in one table.  
- **Safe** ‚Äî preserves existing rows.  
- **Scoped** ‚Äî does not touch unrelated tables or schema.

Proof:
- docs/agent_memory/imp_plans/v2.md still contains the full implementation plan, but the "Patch Plan: Schema Fix & Validation" section now matches the corrected version above, without a documentation step.
